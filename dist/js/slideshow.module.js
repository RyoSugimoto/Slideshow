const pageGraph = '<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="-1 -1 50 50"><circle data-slideshow-page-graph-holder cx="24" cy="24" r="24" /><circle data-slideshow-page-graph cx="24" cy="24" r="24" /></svg>';

class Slideshow {
  pages = []
  currentIndex = 0
  duration = 5000
  paginationContainer = null

  constructor(el, options) {
    this.element = this.getHtmlElement(el);
    if (!this.element) return false

    this.element.setAttribute('data-slideshow', '');

    options = {
      paginationContainer: null,
      duration: 5000,
      ...options
    };

    this.options = options;

    this.slideshowItems = this.element.querySelectorAll(':scope > *');

    this.paginationContainer = this.getHtmlElement(options.paginationContainer);

    this.currentIndex = 0;

    if (this.slideshowItems.length > 0 && this.paginationContainer) {
      this.slideshowItems.forEach((slideshowItem, index) => {
        // loop slides
        slideshowItem.setAttribute('data-slideshow-item', '');
        // create pagination
        this.createPagination(index);
      });
      // append pages
      this.pages.map(page => {
        this.paginationContainer.append(page);
      });
    }
  }

  getHtmlElement(element) {
    if (typeof element !== 'string' && !(element instanceof HTMLElement)) {
      return null
    } else if (typeof element === 'string') {
      element = document.querySelector(element);
    }
    return element
  }

  createPagination(index) {
    const page = document.createElement('span');
    page.insertAdjacentHTML('beforeend', pageGraph);
    page.insertAdjacentHTML('beforeend', index + 1);
    page.setAttribute('data-slideshow-page', '');
    page.style.setProperty('--circumference', 48 * Math.PI);
    this.pages.push(page);
  }

  start() {
    this.startTime = new Date().getTime();
    requestAnimationFrame(() => {
      this.step(this.options.duration);
    });
  }

  step() {
    const timestamp = new Date().getTime();
    const elapsed = timestamp - this.startTime;
    if (this.options.duration > elapsed) {
      this.render(elapsed);
    } else {
      this.startTime = new Date().getTime();
      this.currentIndex = (this.slideshowItems.length <= this.currentIndex + 1) ? 0 : this.currentIndex + 1;
    }
    requestAnimationFrame(() => { this.step(); });
  }

  render(elapsed) {
    this.slideshowItems.forEach((slideshowItem, index) => {
      if (index === this.currentIndex) {
        slideshowItem.classList.add('is-current');
      } else {
        slideshowItem.classList.remove('is-current');
      }
    });

    this.pages.forEach((page, index) => {
      if (index === this.currentIndex) {
        const rate = elapsed / this.options.duration * 100;
        page.classList.add('is-current');
        page.style.setProperty('--progress', Math.round(rate) / 100);
      } else {
        page.classList.remove('is-current');
        page.style.setProperty('--progress', 1);
      }
    });
  }
}

export { Slideshow as default };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2xpZGVzaG93Lm1vZHVsZS5qcyIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2pzL1NsaWRlc2hvdy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBwYWdlR3JhcGggPSAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCI0OFwiIGhlaWdodD1cIjQ4XCIgdmlld0JveD1cIi0xIC0xIDUwIDUwXCI+PGNpcmNsZSBkYXRhLXNsaWRlc2hvdy1wYWdlLWdyYXBoLWhvbGRlciBjeD1cIjI0XCIgY3k9XCIyNFwiIHI9XCIyNFwiIC8+PGNpcmNsZSBkYXRhLXNsaWRlc2hvdy1wYWdlLWdyYXBoIGN4PVwiMjRcIiBjeT1cIjI0XCIgcj1cIjI0XCIgLz48L3N2Zz4nXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNsaWRlc2hvdyB7XG4gIHBhZ2VzID0gW11cbiAgY3VycmVudEluZGV4ID0gMFxuICBkdXJhdGlvbiA9IDUwMDBcbiAgcGFnaW5hdGlvbkNvbnRhaW5lciA9IG51bGxcblxuICBjb25zdHJ1Y3RvcihlbCwgb3B0aW9ucykge1xuICAgIHRoaXMuZWxlbWVudCA9IHRoaXMuZ2V0SHRtbEVsZW1lbnQoZWwpXG4gICAgaWYgKCF0aGlzLmVsZW1lbnQpIHJldHVybiBmYWxzZVxuXG4gICAgdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1zbGlkZXNob3cnLCAnJylcblxuICAgIG9wdGlvbnMgPSB7XG4gICAgICBwYWdpbmF0aW9uQ29udGFpbmVyOiBudWxsLFxuICAgICAgZHVyYXRpb246IDUwMDAsXG4gICAgICAuLi5vcHRpb25zXG4gICAgfVxuXG4gICAgdGhpcy5vcHRpb25zID0gb3B0aW9uc1xuXG4gICAgdGhpcy5zbGlkZXNob3dJdGVtcyA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCc6c2NvcGUgPiAqJylcblxuICAgIHRoaXMucGFnaW5hdGlvbkNvbnRhaW5lciA9IHRoaXMuZ2V0SHRtbEVsZW1lbnQob3B0aW9ucy5wYWdpbmF0aW9uQ29udGFpbmVyKVxuXG4gICAgdGhpcy5jdXJyZW50SW5kZXggPSAwXG5cbiAgICBpZiAodGhpcy5zbGlkZXNob3dJdGVtcy5sZW5ndGggPiAwICYmIHRoaXMucGFnaW5hdGlvbkNvbnRhaW5lcikge1xuICAgICAgdGhpcy5zbGlkZXNob3dJdGVtcy5mb3JFYWNoKChzbGlkZXNob3dJdGVtLCBpbmRleCkgPT4ge1xuICAgICAgICAvLyBsb29wIHNsaWRlc1xuICAgICAgICBzbGlkZXNob3dJdGVtLnNldEF0dHJpYnV0ZSgnZGF0YS1zbGlkZXNob3ctaXRlbScsICcnKVxuICAgICAgICAvLyBjcmVhdGUgcGFnaW5hdGlvblxuICAgICAgICB0aGlzLmNyZWF0ZVBhZ2luYXRpb24oaW5kZXgpXG4gICAgICB9KVxuICAgICAgLy8gYXBwZW5kIHBhZ2VzXG4gICAgICB0aGlzLnBhZ2VzLm1hcChwYWdlID0+IHtcbiAgICAgICAgdGhpcy5wYWdpbmF0aW9uQ29udGFpbmVyLmFwcGVuZChwYWdlKVxuICAgICAgfSlcbiAgICB9XG4gIH1cblxuICBnZXRIdG1sRWxlbWVudChlbGVtZW50KSB7XG4gICAgaWYgKHR5cGVvZiBlbGVtZW50ICE9PSAnc3RyaW5nJyAmJiAhKGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkpIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZWxlbWVudCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGVsZW1lbnQpXG4gICAgfVxuICAgIHJldHVybiBlbGVtZW50XG4gIH1cblxuICBjcmVhdGVQYWdpbmF0aW9uKGluZGV4KSB7XG4gICAgY29uc3QgcGFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKVxuICAgIHBhZ2UuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLCBwYWdlR3JhcGgpXG4gICAgcGFnZS5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWVuZCcsIGluZGV4ICsgMSlcbiAgICBwYWdlLnNldEF0dHJpYnV0ZSgnZGF0YS1zbGlkZXNob3ctcGFnZScsICcnKVxuICAgIHBhZ2Uuc3R5bGUuc2V0UHJvcGVydHkoJy0tY2lyY3VtZmVyZW5jZScsIDQ4ICogTWF0aC5QSSlcbiAgICB0aGlzLnBhZ2VzLnB1c2gocGFnZSlcbiAgfVxuXG4gIHN0YXJ0KCkge1xuICAgIHRoaXMuc3RhcnRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKClcbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgdGhpcy5zdGVwKHRoaXMub3B0aW9ucy5kdXJhdGlvbilcbiAgICB9KVxuICB9XG5cbiAgc3RlcCgpIHtcbiAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKVxuICAgIGNvbnN0IGVsYXBzZWQgPSB0aW1lc3RhbXAgLSB0aGlzLnN0YXJ0VGltZVxuICAgIGlmICh0aGlzLm9wdGlvbnMuZHVyYXRpb24gPiBlbGFwc2VkKSB7XG4gICAgICB0aGlzLnJlbmRlcihlbGFwc2VkKVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnN0YXJ0VGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpXG4gICAgICB0aGlzLmN1cnJlbnRJbmRleCA9ICh0aGlzLnNsaWRlc2hvd0l0ZW1zLmxlbmd0aCA8PSB0aGlzLmN1cnJlbnRJbmRleCArIDEpID8gMCA6IHRoaXMuY3VycmVudEluZGV4ICsgMVxuICAgIH1cbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4geyB0aGlzLnN0ZXAoKSB9KVxuICB9XG5cbiAgcmVuZGVyKGVsYXBzZWQpIHtcbiAgICB0aGlzLnNsaWRlc2hvd0l0ZW1zLmZvckVhY2goKHNsaWRlc2hvd0l0ZW0sIGluZGV4KSA9PiB7XG4gICAgICBpZiAoaW5kZXggPT09IHRoaXMuY3VycmVudEluZGV4KSB7XG4gICAgICAgIHNsaWRlc2hvd0l0ZW0uY2xhc3NMaXN0LmFkZCgnaXMtY3VycmVudCcpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzbGlkZXNob3dJdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWN1cnJlbnQnKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICB0aGlzLnBhZ2VzLmZvckVhY2goKHBhZ2UsIGluZGV4KSA9PiB7XG4gICAgICBpZiAoaW5kZXggPT09IHRoaXMuY3VycmVudEluZGV4KSB7XG4gICAgICAgIGNvbnN0IHJhdGUgPSBlbGFwc2VkIC8gdGhpcy5vcHRpb25zLmR1cmF0aW9uICogMTAwXG4gICAgICAgIHBhZ2UuY2xhc3NMaXN0LmFkZCgnaXMtY3VycmVudCcpXG4gICAgICAgIHBhZ2Uuc3R5bGUuc2V0UHJvcGVydHkoJy0tcHJvZ3Jlc3MnLCBNYXRoLnJvdW5kKHJhdGUpIC8gMTAwKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcGFnZS5jbGFzc0xpc3QucmVtb3ZlKCdpcy1jdXJyZW50JylcbiAgICAgICAgcGFnZS5zdHlsZS5zZXRQcm9wZXJ0eSgnLS1wcm9ncmVzcycsIDEpXG4gICAgICB9XG4gICAgfSlcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE1BQU0sU0FBUyxHQUFHLDJOQUEwTjtBQUM1TztBQUNlLE1BQU0sU0FBUyxDQUFDO0FBQy9CLEVBQUUsS0FBSyxHQUFHLEVBQUU7QUFDWixFQUFFLFlBQVksR0FBRyxDQUFDO0FBQ2xCLEVBQUUsUUFBUSxHQUFHLElBQUk7QUFDakIsRUFBRSxtQkFBbUIsR0FBRyxJQUFJO0FBQzVCO0FBQ0EsRUFBRSxXQUFXLENBQUMsRUFBRSxFQUFFLE9BQU8sRUFBRTtBQUMzQixJQUFJLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxFQUFFLEVBQUM7QUFDMUMsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxPQUFPLEtBQUs7QUFDbkM7QUFDQSxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLGdCQUFnQixFQUFFLEVBQUUsRUFBQztBQUNuRDtB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
